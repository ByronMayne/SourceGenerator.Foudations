<?xml version="1.0" encoding="utf-8" ?>
<Project InitialTargets="SGF_NugetReference">
  <PropertyGroup>
    <IsNugetReference>false</IsNugetReference>
    <IsNugetReference Condition="Exists('$(MSBuildThisFileDirectory)..\.nupkg.metadata')">true</IsNugetReference>
  </PropertyGroup>

  <!-- Reference from nuget package -->
  <Target Name="SGF_NugetReference" Condition="'$(IsNugetReference.ToLower())' == 'true'">
    <Message Importance="high" Text="=========================="/>
    <ItemGroup>
      <SGF_EmbeddedAssembly Include="$(MSBuildThisFileDirectory)..\sgf\embedded\assemblies\*.*"/>
      <SGF_EmbeddedScript Include="$(MSBuildThisFileDirectory)..\sgf\embedded\scripts\*.*"/>
    </ItemGroup>
  </Target>

  <!-- Refernece locally on disk -->
  <Target Name="SGF_LocalReference" BeforeTargets="SGF_EmbedDependencies" Condition="'$(IsNugetReference.ToLower())' == 'false'">
    <Message Importance="high" Text="=========== $(MSBuildThisFileDirectory)..\SourceGenerator.Foundations.Contracts\bin\$(Configuration)\netstandard2.0\SourceGenerator.Foundations.Contracts.dll"/>
    <!--<ItemGroup >
      <SGF_EmbeddedAssembly Include="$(MSBuildThisFileDirectory)..\Plugins\*\bin\$(Configuration)\netstandard2.0\*dll"/>
      <SGF_EmbeddedAssembly Include="$(MSBuildThisFileDirectory)..\SourceGenerator.Foundations.Contracts\bin\$(Configuration)\netstandard2.0\SourceGenerator.Foundations.Contracts.dll"/>
    </ItemGroup>-->
  </Target>

  <ItemGroup Condition="'$(IsNugetReference.ToLower())' == 'false'">
      <ProjectReference Include="$(MSBuildThisFileDirectory)..\SourceGenerator.Foundations\SourceGenerator.Foundations.csproj" ReferenceOutputAssembly="false" OutputItemType="Analyzer"/>
      <ProjectReference Include="$(MSBuildThisFileDirectory)..\SourceGenerator.Foundations.Contracts\SourceGenerator.Foundations.Contracts.csproj" />
  </ItemGroup>
  
  <Import Project="$(MSBuildThisFileDirectory)SourceGenerator.Embedding.props"/>
</Project>
